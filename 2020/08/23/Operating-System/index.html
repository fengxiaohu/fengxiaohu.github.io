<!DOCTYPE html>


<html lang="en" >


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Data structure Algorithm Computer Network" />
   
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Operating-System |  Xiaohu&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

</head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-Operating-System" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Operating-System
</h1>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/08/23/Operating-System/" class="article-date">
  <time datetime="2020-08-23T15:06:18.355Z" itemprop="datePublished">2020-08-23</time>
</a>
      
      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">2.3k字</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">8分钟</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="Operating-System"><a href="#Operating-System" class="headerlink" title="Operating System"></a>Operating System</h1><h2 id="操作系统概述"><a href="#操作系统概述" class="headerlink" title="操作系统概述"></a>操作系统概述</h2><a id="more"></a>

<h3 id="操作系统设计的三个目标："><a href="#操作系统设计的三个目标：" class="headerlink" title="操作系统设计的三个目标："></a>操作系统设计的三个目标：</h3><ul>
<li>便利性</li>
<li>有效性</li>
<li>扩展能力</li>
</ul>
<h3 id="操作系统运行时有哪两种模式："><a href="#操作系统运行时有哪两种模式：" class="headerlink" title="操作系统运行时有哪两种模式："></a>操作系统运行时有哪两种模式：</h3><ul>
<li><p>作为硬件层与应用层之间的一个接口，也就是通常意义上硬件与软件之间的缓冲层。</p>
</li>
<li><p>作为资源管理器，管理计算机资源（IO，内存，等等）</p>
<ul>
<li><p>Functions in the same way as ordinary computer software</p>
</li>
<li><p>Program, or suite of programs, executed by the processor</p>
</li>
<li><p>Frequently relinquishes control and must depend on the processor to allow it to regain control</p>
</li>
</ul>
</li>
</ul>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C2_1.jpg" alt></p>




<h3 id="操作系统发展"><a href="#操作系统发展" class="headerlink" title="操作系统发展"></a>操作系统发展</h3><ul>
<li><p>Serial Processing 串行处理</p>
</li>
<li><p>Simple Batch Systems 简单批处理</p>
</li>
<li><p>Multiprogrammed Batch Systems 多道批处理系统</p>
</li>
<li><p>Time Sharing Systems 分时系统</p>
<table>
<thead>
<tr>
<th></th>
<th>Batch Multiprogramming</th>
<th>Time sharing</th>
</tr>
</thead>
<tbody><tr>
<td>principal objective</td>
<td>Maximize processor use</td>
<td>Minimize response time</td>
</tr>
<tr>
<td>Source of directives to operating system</td>
<td>Job control language</td>
<td>commmands entered at the termial</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="与串行处理相比，多道程序设计有哪些优势"><a href="#与串行处理相比，多道程序设计有哪些优势" class="headerlink" title="与串行处理相比，多道程序设计有哪些优势"></a>与串行处理相比，多道程序设计有哪些优势</h3><p>基于cpu执行指令的速度远远超过了I/O设备的处理速度，在程序执行的整个生命周期中，大量的时间被浪费在了等待I/O操作上。</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C2_3.jpg" alt></p>
<p>多道批处理系统通过一次将准备运行的多个job载入内存中，当一个正在执行中的job需要I/O时，可以转去执行另外一个job。这种近似于并发执行的方式大大提高了程序执行的速率。</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C2_4.jpg" alt></p>
<p>此外，由于一次将准备运行的多个job载入内存，进一步需要内存管理，同时在多个job间进行切换也需要使用调度算法。</p>
<h3 id="什么是进程"><a href="#什么是进程" class="headerlink" title="什么是进程"></a>什么是进程</h3><p>一个正在执行中程序的实例。</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C2_5.jpg" alt></p>
<p>同时进程还包括了以下三个组件</p>
<ul>
<li>可执行程序</li>
<li>与此可执行程序相关的数据（变量，缓冲，等）</li>
<li>程序状态/执行上下文 process state/ execution context </li>
</ul>
<h3 id="操作系统是怎样使用进程的执行上下文的"><a href="#操作系统是怎样使用进程的执行上下文的" class="headerlink" title="操作系统是怎样使用进程的执行上下文的"></a>操作系统是怎样使用进程的执行上下文的</h3><p>进程上下文（The execution context/process state） 是操作系统管理和控制进程的内部数据。 execution context是与进程本身分开的，避免操作系统直接被进程所访问到。进程上下文包含了两部分信息，一部分是管理进程相关的信息，另外一部分是处理器执行进程所需要的信息。</p>
<h3 id="列出并简要介绍五种操作系统中的内存管理功能"><a href="#列出并简要介绍五种操作系统中的内存管理功能" class="headerlink" title="列出并简要介绍五种操作系统中的内存管理功能"></a>列出并简要介绍五种操作系统中的内存管理功能</h3><ul>
<li><p>进程隔离 </p>
<p>操作系统必须保证每个进程不会干扰到其他进程的内存空间</p>
</li>
<li><p>自送分配与管理 </p>
<p>动态分配内存</p>
</li>
<li><p>模块化编程</p>
</li>
<li><p>保护与访问控制</p>
</li>
<li><p>永久存储</p>
</li>
</ul>
<h3 id="解释实地址和虚地址的区别"><a href="#解释实地址和虚地址的区别" class="headerlink" title="解释实地址和虚地址的区别"></a>解释实地址和虚地址的区别</h3><p>实地址就是物理地址，是程序在内存中的实际地址</p>
<p>虚拟地址是在虚拟内存中的地址</p>
<h3 id="描述时间片轮转调度技术"><a href="#描述时间片轮转调度技术" class="headerlink" title="描述时间片轮转调度技术"></a>描述时间片轮转调度技术</h3><p>为每个进程分配一定的时间片，通过环形队列</p>
<h3 id="说明单内核与微内核之间区别"><a href="#说明单内核与微内核之间区别" class="headerlink" title="说明单内核与微内核之间区别"></a>说明单内核与微内核之间区别</h3><p>单内核架构（<strong>monolithic kernel</strong> ）会将OS所提供的大部分功能集中在内核实现，包括</p>
<ul>
<li>scheduling</li>
<li>file system</li>
<li>networking</li>
<li>device drivers</li>
<li>memory management</li>
</ul>
<p>典型情况下，这个大内核是作为一个进程实现的，所有元素都共享相同的地址空间</p>
<p>微内核架构（microkernel architecture）仅仅将一些必要的功能放在内核中实现</p>
<ul>
<li>address spaces, interprocess</li>
<li>communication (IPC)</li>
<li>basic scheduling</li>
</ul>
<p>其他的一些服务由进程来提供，运行在用户态。极大地提升了操作系统的可定制性，用户可以根据不同的场景和应用来定制一些模块使用。在分布式系统有很大优势。</p>
<h3 id="什么是多线程"><a href="#什么是多线程" class="headerlink" title="什么是多线程"></a>什么是多线程</h3><p>多线程（<strong>Multithreading</strong>）是可以将一个进程分成许多线程，然后并发运行这些线程</p>
<p>• <strong>Thread:</strong> A dispatchable unit of work. It includes a processor context (which</p>
<p>includes the program counter and stack pointer) and its own data area for a</p>
<p>stack (to enable subroutine branching). A thread executes sequentially and is</p>
<p>interruptible so that the processor can turn to another thread.</p>
<p>• <strong>Process :</strong> A collection of one or more threads and associated system resources</p>
<p>(such as memory containing both code and data, open files, and devices). This</p>
<p>corresponds closely to the concept of a program in execution. By breaking</p>
<p>a single application into multiple threads, the programmer has great control</p>
<p>over the modularity of the application and the timing of application-related</p>
<p>events.</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C2_6.jpg" alt></p>
<p>多线程技术面对的是同时运行许多互相独立的应用的场景。典型的例子如数据库。</p>
<h2 id="进程描述与控制"><a href="#进程描述与控制" class="headerlink" title="进程描述与控制"></a>进程描述与控制</h2><h3 id="什么是进程的轨迹（trace）"><a href="#什么是进程的轨迹（trace）" class="headerlink" title="什么是进程的轨迹（trace）"></a>什么是进程的轨迹（trace）</h3><p>将单个进程的执行抽象为一系列的二进制的指令，这样我们就可以直观地从地址的变化上观察程序的执行。</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.2.jpg" alt></p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.3.jpg" alt></p>
<h3 id="基于下图简单描述五个状态"><a href="#基于下图简单描述五个状态" class="headerlink" title="基于下图简单描述五个状态"></a>基于下图简单描述五个状态</h3><p><img src="/2020/08/23/Operating-System/Operating-System%5C3.4.jpg" alt="图3.4五状态模型"></p>
<ul>
<li><p>running 进程正在被执行</p>
</li>
<li><p>Ready 进程已经准备好，将要被调度器执行</p>
</li>
<li><p>Blocked 进程在某些事件执行完成之前都不能被执行.eg:等待I/O的完成</p>
</li>
<li><p>New 进程刚刚被OS创建，还未加载入内存中</p>
</li>
<li><p>结束态 进程结束，所占用的系统资源被释放</p>
</li>
</ul>
<h3 id="五个状态之间的相互转换"><a href="#五个状态之间的相互转换" class="headerlink" title="五个状态之间的相互转换"></a>五个状态之间的相互转换</h3><ul>
<li><p>null -&gt; new 一个新的进程被创建</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.5.jpg" alt></p>
</li>
</ul>
<ul>
<li><p>new-&gt; Ready 当OS准备一个新进程的执行命令时，它会将相应的进程从new转换为ready</p>
</li>
<li><p>Ready-&gt; Running: 处理器处于空闲状态时，调度器选择一个Ready状态的进程去运行</p>
</li>
<li><p>Running-&gt;exit: 当进程结束或者时被OS撤销时，进入exit。通常来说可能因为以下原因进入到exit状态</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.6.JPG" alt></p>
</li>
<li><p>Running-&gt;ready</p>
<p>进程由于耗尽时间片（Time slice）而进入ready状态，通常由于优先级高于此进程的其他进程抢占此进程的执行权，致使其进入ready状态</p>
<p>Time slice：The period of time for which a process is allowed to run in a preemptive multitasking system is generally called the <em>time slice</em> or <em>quantum</em>. The scheduler is run once every time slice to choose the next process to run. The length of each time slice can be critical to balancing system performance vs process responsiveness - if the time slice is too short then the scheduler will consume too much processing time, but if the time slice is too long, processes will take longer to respond to input.</p>
</li>
<li><p>Running-&gt;Blocked</p>
<p>在执行过程中由于进程本身发出请求，等待回应而不得不暂时中断执行。最常见的情况是此进程在执行过程中发出了I/O请求，在前面提到过，I/O请求的时间远远超过了cpu的执行时间，如果CPU原地等待中断执行完成的话，时间上会造成极大的浪费。</p>
</li>
<li><p>Blocked-&gt; Ready </p>
<p>进程所等待的事件出现</p>
</li>
</ul>
<h3 id="抢占一个进程意味着什么"><a href="#抢占一个进程意味着什么" class="headerlink" title="抢占一个进程意味着什么"></a>抢占一个进程意味着什么</h3><p>假设A为一个正在运行的进程，B为优先级高于A，处于Blocked的状态。在A正在运行的时候，B所等待的事件到达。调度器中断A的执行，转而去执行B。这就意味着进程B抢占了进程A。</p>
<h3 id="进程繁殖"><a href="#进程繁殖" class="headerlink" title="进程繁殖"></a>进程繁殖</h3><p>一个进程在执行中创建了新的子进程。</p>
<h3 id="为什么下图有两个阻塞态"><a href="#为什么下图有两个阻塞态" class="headerlink" title="为什么下图有两个阻塞态"></a>为什么下图有两个阻塞态</h3><p><img src="/2020/08/23/Operating-System/Operating-System%5C3.7.JPG" alt></p>
<ul>
<li><p>suspend的出现</p>
<p>考虑一个没有虚拟内存支持的系统，状态数目如上面的5状态图中，不存在suspend状态。那么所有running 和blocked 的状态都会被全部载入内存中。内存空间的容量会大大限制并发的进程数量，降低系统的运行速度</p>
</li>
<li><p>CPU idle</p>
<p>由于CPU的运行速率要比内存快上三个数量级，纵然内存载入许多进程，达到了所能容纳数量的上限，那么仍然会因为载入的所有进程都进入block状态，使得CPU闲置下来。</p>
</li>
<li><p>解决方案</p>
<ol>
<li><p>增加内存容量 </p>
<p>内存价格过于昂贵，且内存价格并不是随着容量线性增长，在后期一点点内存容量的提升都会引起价格的大幅度上涨。</p>
</li>
<li><p>虚拟存储技术（swapping）</p>
<p>将进程的一部分或者是整个进程从内存交换到硬盘。当系统中所有进程都进入blocked状态，OS将其中一个进程标记为suspend状态并内存将它交换到磁盘，同时内存有新的空间来调度新的进程。</p>
</li>
</ol>
</li>
<li><p>增加一个新的block状态，命名为suspend。考虑到进程是否等待某个事件（是否阻塞）与进程是否被换出内存（是否挂起），那么互相组合之后就会有4种新的状态，自然也就新增加了两个阻塞态</p>
<ul>
<li>blocked suspended</li>
<li>blocked unsuspended</li>
<li>unblocked unsuspended</li>
<li>unblocked suspended<h3 id="列出挂起进程的四个状态"><a href="#列出挂起进程的四个状态" class="headerlink" title="列出挂起进程的四个状态"></a>列出挂起进程的四个状态</h3></li>
</ul>
</li>
<li><p>进程不能被立即调入执行</p>
</li>
<li><p>进程可能在等待事件发生</p>
</li>
<li><p>进程可以被它的父进程，OS，或者自己置为挂起态</p>
</li>
<li><p>挂起状态不能被移除，只有等到收到将此进程挂起的实体的信号才可以解除挂起</p>
</li>
</ul>
<p>下面是挂起的原因</p>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.8.JPG" alt></p>
<h3 id="操作系统维护哪些状态表来对哪些类型的实体进行管理"><a href="#操作系统维护哪些状态表来对哪些类型的实体进行管理" class="headerlink" title="操作系统维护哪些状态表来对哪些类型的实体进行管理"></a>操作系统维护哪些状态表来对哪些类型的实体进行管理</h3><ul>
<li>Memory Tables 记录物理内存与虚拟内存的使用状态</li>
<li>I/O tables   管理I/O 设备</li>
<li>file tables </li>
<li>process tables</li>
</ul>
<p><img src="/2020/08/23/Operating-System/Operating-System%5C3.9.JPG" alt></p>
<h3 id="进程镜像由哪些元素组成"><a href="#进程镜像由哪些元素组成" class="headerlink" title="进程镜像由哪些元素组成"></a>进程镜像由哪些元素组成</h3><p>进程相关联的程序，数据，堆栈，以及属性参数构成进程镜像</p>
<h3 id="为什么需要两种模式（user-mode-kernel-mode）"><a href="#为什么需要两种模式（user-mode-kernel-mode）" class="headerlink" title="为什么需要两种模式（user mode/kernel mode）"></a>为什么需要两种模式（user mode/kernel mode）</h3>
      
      <!-- reward -->
      
      <div id="reward-btn">
        打赏
      </div>
      
    </div>
    
    
      <!-- copyright -->
      
        <div class="declare">
          <ul class="post-copyright">
            <li>
              <i class="ri-copyright-line"></i>
              <strong>版权声明： </strong s>
              本博客所有文章除特别声明外，均采用 <a href="https://www.apache.org/licenses/LICENSE-2.0.html" rel="external nofollow"
                target="_blank">Apache License 2.0</a> 许可协议。转载请注明出处！
            </li>
          </ul>
        </div>
        
    <footer class="article-footer">
      
          
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://fengxiaohu.github.io/2020/08/23/Operating-System/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>
      
      

    </footer>

  </div>

  
  
  <nav class="article-nav">
    
    
      <a href="/2020/07/22/linear-table/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">linear table</div>
      </a>
    
  </nav>


  

  
  
<!-- valine评论 -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: '',
        app_key: '',
        path: window.location.pathname,
        notify: 'false',
        verify: 'false',
        avatar: 'mp',
        placeholder: '给我的文章加点评论吧~',
        recordIP: true
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>
<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2015-2020
        Xiaohu Feng
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Xiaohu&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/Leetcode">Leetcode</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/CSAPP">CSAPP</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/algorithm">算法</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['信心比黄金更加珍贵', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 100,
      showCursor: true
    });
  } catch (err) {
  }

</script>




<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>



<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>



<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=448754936&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>